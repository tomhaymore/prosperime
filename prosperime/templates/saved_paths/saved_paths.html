{% extends "base.html" %}

{% block head %}

<script type="text/javascript" src="{{ STATIC_URL }}js/saved_paths.js"></script>

{% endblock %}

<!-- Messages -->
{% block message %}
	{% if messages %}
	<ul class="messages">
    	{% for message in messages %}
    		<li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    	{% endfor %}
	</ul>
	{% endif %}
{% endblock %}


<!-- Left Sidebar -->
{% block sidebar %} 

{% endblock %}


<!-- Content -->
{% block content %}
<!-- BACKBONE JUMPS IN HERE -->
<div id="saved-paths-list"></div>
{% endblock %}


<!-- Right Sidebar -->
{% block rightSidebar %}
<div id="search-right-sidebar">
	<div class="rounded">
		{% if user %}
			<p class="sidebar-header">Want to see improvements?</p>
			<p>We'd love to hear from you -- <a href="mailto:feedback@prosperime.com">please drop us a line</a></p>	
		{% else %}
			<!-- CLAY: ?? -->
			<p class="sidebar-header">Want to see full career paths?</p>
			<p>Drag and drop any company you'd like to keep track of here.</p>
		{% endif %}
	</div>

	<div class="rounded">
		<p class="sidebar-header">Save Search</p>
		{% if user %}
			<p><a href="#">Save this search</a> to come back and review search results any time.</p>
		{% else %}
			<p><a href="/login">Login</a> or <a href="/register">register</a> to save searches.</p>
		{% endif %}
	</div>

	<div class="rounded">
		<p class="sidebar-header">Your Saved Career Paths</p>
		
		{% if saved_paths %}
			<table class="table table-striped table-condensed table-bordered path-list" id='sidebar-path-list'>			
				{% for saved_path in saved_paths %}
					{% if forloop.last %}
						<tr class="saved-path-list-last">
					{% else %}
						<tr>
					{% endif %}
						<td ondragover='allowDrop(event)' ondrop='dropPosition(event, "{{saved_path.title}}", this)'><a href="/saved_paths/#title/?t={{saved_path.title}}">{{saved_path.title}}</a></td>
					</tr>
			{% endfor %}
			</table>
		{% else %}
			<p>You haven't saved any career paths yet. Start one <a href="/saved_paths/create/">here.</a></p>
		{% endif %}
	</div>
</div>


<!-- CLAY: START AUTHENTICATE -->
{% if not user.profile.li_linked %}
	{{ user.li_linked }}
	<div class="rounded">
		<a class="btn btn-primary left-spacer" href="/account/authorize">Authorize</a>
	</div>
{% endif %}
<!-- CLAY: END AUTHENTICATE -->

{% endblock %}

{% block templates %}
<script type="text/template" id="saved-path-list-template">
	<!--<div class="main-header pull-left">Career Paths</div><div class="pull-right btn-group disabled"><button class="btn-small">Paths</button><button class="btn-small">Companies</button></div>-->
	<div class="main-header pull-left">Career Paths</div>
	<div class="search-view pull-right">Search: 
		<ul class="search-view-links inline">
			<li><a href="/search/#companies/">companies</a></li>
			<li><a href="/search/#careers/">careers</a></li> 
		</ul>
	</div>
	<div class="clearfix"></div>
	<ul class="path-list"></ul>
</script>

<script type="text/template" id="saved-path-single-template">
	<ul class="single-saved-path-list">
		<li class="single-saved-path-pos">
			<div class="saved-path-title"><%=title%></div>
			<% if (positions != null) {
				 for (var i = 0; i < positions.length; i++) {
					%><div class='saved-path-position'>
						<%= positions[i].title %> at <%= positions[i].co_name%> <a href="/saved_paths/delete/<%=title%>/<%=positions[i].id%>">Remove</a>
					</div><%
				}
			} %>		
		</li>
	</ul>
</script>

<script type="text/template" id="all-paths-template">
	<table class="all-paths-table">
		<tr class="all-paths-table-row">
			<td class="all-paths-table-col">
				<% if (title != null) {
					
				} %>
			</td>
		</tr>
	</script>
{% endblock %}