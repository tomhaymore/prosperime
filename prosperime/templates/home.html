{% extends "base_full.html" %}

{% block head %}

<link type="text/css" rel="stylesheet" href="{{ STATIC_URL }}css/discover.css" />
<script type="text/javascript" src="{{ STATIC_URL }}js/discover.js"></script>
{% endblock %}

{% block content %}

<div id="content-container" class="main-container">
	<!-- <div class="pull-left">
		<img src="/media/{{user.profile.default_profile_pic}}">
	</div> -->
	<div class="pull-left dashboard-header">
		<p class="splash-header">Dashboard</p>
		<ul class="module-list main-sub-header">
			<li><a href="/profile/{{user.id}}" onclick="_gaq.push(['_trackEvent', 'home', 'viewProfile', '{{user.id}}'])">View profile</a></li>
			<li><a href="/discover" onclick="_gaq.push(['_trackEvent', 'home', 'discoverCareers', '{{user.id}}'])">Discover careers</a></li>
			<li><a href="/search/" onclick="_gaq.push(['_trackEvent', 'home', 'search', '{{user.id}}'])">Search</a></li>
			{% if not user.profile.li_linked %}
				<li><a href="/account/authorize" onclick="_gaq.push(['_trackEvent', 'home', 'authorize', '{{user.id}}'])">Authorize</a></li>
			{% endif %}
		</ul>
	</div>
	<div class="clear"></div>
	<div class="dashboard-module pull-left" data-name="dashboard-careers">
		<p class="module-header">My Careers
			<span class='module-whats-this'><a onclick="whatsThis('careers', this.parentNode.parentNode)">What's this?</a></span>
		</p>

			{% if user_careers %}
				<table class="table table-striped table-condensed table-bordered" data-name="careers-list">

				{% for c in user_careers %}
					<tr><td>
						<a href="/discover/career/{{c.id}}" onclick="_gaq.push(['_trackEvent', 'home', 'careerClicked', '{{c.id}}'])">{{c.name}}</a>
					</td></tr>
				{% endfor %}
				<tr><td class="bolder">
						<a href="/discover/" onclick="_gaq.push(['_trackEvent', 'home', 'discoverMoreCareers', '{{user.id}}'])">Discover more careers</a>
					</td></tr>
				</table>
			{% endif %}
		<!--<p class="sub-header"><a href="/discover">Discover more careers</a></p>-->
	</div>
	<div class="dashboard-module pull-left" data-name="dashboard-saved-paths">
		<p class="module-header">Saved Paths</p>
		{% if saved_paths %} 
			<table class="table table-striped table-condensed table-bordered" data-name="saved-paths-list">
				<tr><td class="bolder">
					<a href="/saved_paths/" onclick="_gaq.push(['_trackEvent', 'home', 'savedPaths', 'all'])">View All</a>
				</td><tr>
			{% for s in saved_paths %}
				<tr><td>
					<a href="/saved_paths/#id/?id={{s.id}}" onclick="_gaq.push(['_trackEvent', 'home', 'savedPaths', '{{s.id}}']")>{{s.title}}</a> 
					<span class="badge">{{s.positions|length}}</span>
				</td></tr>
			{% endfor %}
			</table>
		{% else %}
			<p>You don't have any saved paths. <a href="#">Add one now</a>.</p>
		{% endif %}
	</div>
	<div class="dashboard-module pull-left" data-name="dashboard-top-careers">
		<p class="module-header">Top Careers in Network</p>
		{% if top_careers %} 
			<ul data-name="top-careers-list">
			{% for c in top_careers %}
				<li><a href="/discover/career/{{c.id}}">{{c.name}}</a></li>
			{% endfor %}
			</ul>
		{% else %}
			<p>Coming soon</p>
		{% endif %}
	</div>
	<div class="clear"></div>
</div>


<script type="text/javascript">

	var whatsThis = function(origin, elem) {

		_gaq.push(['_trackEvent', 'home', 'whatsThis'])
		if (origin == "careers") {
			// If its already there, delete it
			if ($('#module-info-careers').length > 0) {
				$('#module-info-careers').remove()
				return true;
			}
			
			// Else, delete everything else
			$('.module-info').each(function() {
				$(this).remove()
			});

			$(elem).after("<table id='module-info-careers' class='module-info table table-condensed table-bordered table-striped'><tr><td>After analyzing your work and that of the Prosperime Community, we selected the following career paths as those of potential interest for you. We have collected information on jobs, companies, and people in the field, and we hope it will help you on your way to forging a meaningful, lasting career.</td></tr></table>")

		}
	};

</script>

{% endblock %}