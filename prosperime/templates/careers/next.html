{% extends "base_full.html" %}

{% block head %}
<!-- JS -->
<script type="text/javascript" src="{{ STATIC_URL }}js/raphael-min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/underscore.js"></script>
<script type='text/javascript' src="{{ STATIC_URL }}js/next.js"></script>
<script type='text/javascript' src="{{ STATIC_URL }}js/backbone.js"></script>

<!-- CSS --> 
<link type="text/css" rel="stylesheet" href="{{ STATIC_URL }}css/next.css" />
<link type='text/css' rel='stylesheet' href='{{ STATIC_URL }}css/font-awesome.min.css'/>

{% endblock %}

<!-- Messages -->
{% block message %}

{% endblock %}


<!-- Content (center pane) -->
{% block content %}
<div class="main-container content-container">

	<div class='container-header'>
		<h3>
			<span class='sub-header'>What Next?  </span>
			<span id='industry-header'></span>
		</h3>
	</div>


	<div id='search-filters-container'>
		<!-- Backbone here -->
	</div>


	<div id="search-results-container">
	<!-- Backbone here -->
	</div>
</div>
{% endblock %}




{% block templates %}
<script type="text/template" id="search-filters-template">
	<div class="main-sub-header">Search Filters</div>
	<% 
		_.each(filters, function(f) {
			%>
				<label class="radio inline">
					<input type="radio" name="search-filters" id="<%=f%>"><%=f%>
				</label>
			<%
		})
	%>

</script>

<script type='text/template' id='lvl1-template'>

	<h3>Search Results: </h1>

	<table id='search-results-table' class='table table-hover'>
		<thead>
			<tr>
				<th><div class="people-box"><%=total_people%> Total People</div></th>
				<th><div class="content-box"><%=start_name%></div></th>
			<tr>
		</thead>

		<tbody>
			<%
				transitions = _.sortBy(transitions, function(value) {
					return -value[1]
				})
			
				for (var i = 0; i < transitions.length; i++) {
					
					var value = transitions[i]
					var end_name = value[0]
					var num_people = value[1]
					var end_id = value[3]
					console.log('v: ' + value)
					%><tr id="<%=start_id%>-<%=end_id%>">
						<td><div class="people-box"><%=num_people%>
							<%if (num_people == 1) { %>
								Person
							<% } else { %>
								People
							<% } %>
						 </div></td>
						<td>
							<div class="content-box">
								<%=start_name%>  
									<i class="icon-arrow-right"></i>  
								<%=end_name%>
							</div>
						</td>
					</tr><%
				};
			%>
		</tbody>
	</table>

</script>

<script type='text/template' id='lvl2-template'>

	<h3 class="inline">Search Results: </h3>
		<span class="previous-search pull-right inline">Back</span>

		<h5>"show me people who went from the <i><%=start_name%></i> Industry to the <i><%=end_name%></i> Industry"</h5>

	<table id='search-results-table' class='table table-hover'>
		<thead>
			<tr>
				<th><div class="people-box"><%=total_people%> Total People</div></th>
				<th>
					<div class="content-box">
						<%=start_name%>
							<i class="icon-arrow-right"></i>
						<%=end_name%>
					</div>
				</th>
			<tr>
		</thead>

		<tbody>
			<%
				_.each(people, function(value, key) {
					// console.log('k: ' + key)
					// console.log('v: ' + value)
					var person = value[0]
					var person_id = key
					var move = value[1]
					console.log(move)
					var start_pos_name = move.start_title
					var start_pos_entity = move.start_entity_name
					var end_pos_name = move.end_title
					var end_pos_entity = move.end_entity_name
					%>
					<tr id="<%=person_id%>">
						<td>
							<div class="people-box">
								<a href="/profile/<%=person_id%>"><%=person%></a>
							</div>
						</td>

						<td>
							<div class="content-box">
								<%=start_pos_name%> / <%=start_pos_entity%>
									<i class="icon-arrow-right"></i>
								<%=end_pos_name%> / <%=end_pos_entity%>
							</div>
						</td>
					</tr>
					<%
				});
			%>
		</tbody>
	</table>

</script>


<script type="text/javascript">

</script>

{% endblock %}

